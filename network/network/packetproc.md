---
description: 메시지 프로토콜 종류에 따라 필요한 동작을 구현
---

# PacketProc

## 설명

세션으로부터 받은 패킷에 담긴 메시지 프로토콜의 내용에 따라  
다르게 처리할 수 있게 구현한 파일입니다.  
다음과 같은 주요 기능들을 제공합니다.

1. 세션 연결/해제  
2. 로그인 단계 메시지 \(로그인 , 회원가입, 대기실 전환\)  
3. 대기실 단계 메시지 \(방 생‌성 , 방 목록 불러오기, 방 접속\)  
4. 방 단계 메시지 \(게임 시작, 방 퇴장, 대기실 복귀, 유저 입장/퇴장\)  
5. 게임 단계 메시지 \(케릭터 정보,  위치, ..\)

## Session & Login Functions

| 함수명 | 설명 |
| :--- | :--- |
| ConnectSession | accpet된 사용자를 세션 목록에 추가한다 |
| DisconnectSession | 사용자를 세션 목록에서 제거한다 |
| LoginAuth | 로그인 요청이 들어온 경우의 결과에 대한 패킷을 unicast 방식으로 큐에 담는다 |
| MembershipAuth | 회원가입 요청이 들어온 경우의 결과에 대한 패킷을 unicast 방식으로 큐에 담는다. |
| GotoLobby | 세션 상태를 LOBBY로 전환하고 전환 메시지를 보낸다 |



## Lobby Functions

| 함수명 | 설명 |
| :--- | :--- |
| RoomCreate | 방을 생성하는데 성공하면 세션 상태를 INROOM으로 전환하고 방 번호 메시지를 보냄 |
| RoomEnter | 방에 입장한 유저에게 방 내부 인원을 알리는 정보를 담고 방 내부 인원들에겐 입장한 유저의 정보를 보냄 |
| RoomList | 세션 상태가 LOBBY로 상태가 변경되고 대기실로 진입되었을 때, 방 정보를 불러오기 위함 |

## Room Functions

| 함수명 | 설명 |
| :--- | :--- |
| GameStart | 게임 시작 메시지를 모두에게 전송하고 스레드로 분리하는 작업을 진행함 |
| RoomExit | 방장이 아닌 유저의 방 퇴장 요청, 다른 사람에게 나갔음을 알린다 |
| HostRoomExit | 방장이 방 퇴장을 함에따라 방 내부 모든 인원이 \(방장\)퇴장 메시지를 받는다 |
| ReturnLobby | 퇴장 메시지를 받은 모든 유저들의 세션을 LOBBY 상태로 전환시킨다 |

## Game Functions

| 함수명 | 설명 |
| :--- | :--- |
| CharacterInfo | 게임 시작시 유저의 케릭터에 대한 정보 전송 |
| MoveStart | 유저가 움직이면 움직임 정보에 대한 패킷을 broadcast 방식으로 큐에 담는다 |
| MoveStop | 유저의 움직임이 중단되면 현재 위치 정보에 대한 패킷을 broadcast 방식으로 큐에 담는다 |

